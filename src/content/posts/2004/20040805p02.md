---
title: さくらインターネット その６ - 日記データの移行
date: 2004-08-05T00:00:00.000Z
lastmod: 2007-09-01T17:22:43.000Z
draft: false
tags:
  - memo
---

XREAに設置している tDiary の日記データを、さくらのサーバに移した。 tDiary はプログラムとデータがうまく分離されているので、移行はそれほど難しくなかった。

tDiary本体は、これまでも自宅サーバから XREA にアップロードしていたので、 これをさくらにも同じようにアップロードするだけ。 .htaccess と tdiary.conf はさくらの環境に書き換えた。

データの移行には sitecopy を使った。 まず sitecopyrc に以下のように記述しておく。

```
site xrea-tdiary-data
  server example.xrea.com
  username machu
  password **********
  local /home/machu/var/tdiary
  remote /data/tdiary

site sakura-tdiary-data
  server example.sakura.ne.jp
  username machu
  password **********
  local /home/machu/var/tdiary
  remote /home/machu/var/tdiary/
```

sitecopy を使って XREA から日記データを取得する。

```
$ sitecopy --fetch xrea-tdiary-data
$ sitecopy --catchup xrea-tdiary-data
```

次にこのデータをさくらのサーバへ転送する。 （あらかじめさくらのサーバに /home/machu/var/tdiary というディレクトリは作っておく）

```
$ sitecopy --initialize sakura-tdiary-data
$ sitecopy --update sakura-tdiary-data
```

これで日記データの移行は完了。 ツッコミやリンク元などの情報もちゃんと移行されている。

あとは、絵日記プラグインを使ってアップロードした画像も 忘れずにコピーする。 （tDiaryのCGIディレクトリの下の images ディレクトリにある） こっちは数が少ないので、FTPソフトを使って手動でやってもいい。
