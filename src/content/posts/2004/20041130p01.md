---
title: gonzui on AIX
date: 2004-11-30T00:00:00.000Z
lastmod: 2006-06-08T12:52:02.000Z
draft: false
tags:
  - Ruby
---

昨日リリースされた [gonzui](http://namazu.org/~satoru/gonzui/) を使ってみようと思う。 手元で使えるマシンは AIX 5.2 のみ。一抹の不安を覚えながら挑戦。

Ruby は先日インストールしておいたので、他に必要なのは Berkeley DB と BDB binding for Ruby の2つ。

#### コンパイラ

事前に[IBMのダウンロードサイト](http://www-1.ibm.com/servers/aix/products/aixos/linux/ezinstall.html)から gcc と gcc-c++ の RPM を取得し、インストールしておく（C++のコンパイラは不要だったかも…）。

```
rpm -ivh gcc-3.3.2-4.aix5.1.ppc.rpm
rpm -ivh gcc-cplusplus-3.3.2-4.aix5.2.ppc.rpm
```

ちなみに -ivh オプションは新規インストールの場合。アップデートの場合は -U オプションを使う。

#### Berkeley DB

[公式サイトのダウンロードページ](http://www.sleepycat.com/download/db/index.shtml)から、最新版 (4.3.21) を取得する。ここでは暗号化に対応していない版を持ってきた。

あとは展開してインストールするのみ。ただし、 configure スクリプトはなぜかトップレベルで動かないようになっているので、適当なディレクトリに移ってから実行する。

```
$ gzip -cd db-4.3.21.NC.tar.gz | tar xvf -
$ cd db-4.3.21.NC/docs
$ ../dist/configure  --prefix=/usr/local
(中略)
checking for C compiler default output file name... configure: error: C compiler cannot create executables
See `config.log' for more details.
```

C コンパイラのところでエラーになってしまった。 config.log を見ると、コンパイラの場所を見つけられていないようなので、環境変数 CC を設定して再度実行。

```
$ export CC=/usr/local/bin/gcc
$ ../dist/configure  --prefix=/usr/local
$ make
$ sudo make install
```

これでうまくいった。ちなみに --prefix をつけないと /usr/local/BerkeleyDB.4.3/ へとインストールされる。

#### BDB binding for Ruby

次は Berkeley DB の Ruby バインディング。 [RAA](http://raa.ruby-lang.org/project/bdb)より、 bdb / 0.5.3 を取得して展開。

```
$ gzip -cd bdb.tar.gz | tar xvf -
$ cd bdb-0.5.3/
$ ruby extconf.rb --with-db-dir=/usr/local --with-db-version=-4.3
extconf.rb: Entering directory `src'
checking for db_version() in -ldb-4.3... no
checking for db_version_4003() in -ldb-4.3... no
extconf.rb:80: libdb-4.3 not found (RuntimeError)
        from extconf.rb:66:in `catch'
        from extconf.rb:66
extconf.rb: Leaving directory `src'
```

と、ここでエラー。オプションをいろいろと変えてみても同じ。/usr/local/lib には libdb-4.3.a や libdb-4.3.so がちゃんと存在するのに。 ここで行き詰ってしまったので一旦中断。Berkeley DB を 4.2 にして、もう一度挑戦してみるかな。
