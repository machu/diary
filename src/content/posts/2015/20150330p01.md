---
title: Ruby2.2.1 + tDiary4.1.2へアップデート
date: 2015-03-30T00:00:00.000Z
lastmod: 2015-03-30T13:00:49.000Z
draft: false
tags:
  - tDiary
---

という訳で、この日記も最新の環境にアップデートした。gitで管理しているので、いつもどおり git pull を実行。2つのファイルが衝突した。

```
$ git pull origin master
error: Your local changes to the following files would be overwritten by merge:
        Gemfile.lock
        config.ru
Please, commit your changes or stash them before you can merge.
```

Gemfile.lockはGemfile.local分が反映されているので衝突。これはいったん本体側に合わせればいい。

```
$ git checkout -- Gemfile.lock
```

config.ruはbase\_urlを設定しているので衝突。これは本体側に合わせたあとに、もう一回base\_urlを設定しなおした。

```
$ git checkout -- config.ru
$ git pull origin master
$ vim config.ru
(base_urlを書き換え)
```

Rubyはrbenvを使って最新版を入れた。最後にunicornを再起動してアップデート完了。特に問題なし。

```
$ kill -TERM `cat unicorn.pid `
$ bundle exec unicorn -c unicorn.conf -E production -D
```

毎回config.ruのbase\_urlを指定するのは面倒なので、ここはtdiary.confに書けるようにしたいな。
