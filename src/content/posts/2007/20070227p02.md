---
title: でも一部動かない (FeedTools)
date: 2007-02-27T00:00:00.000Z
lastmod: 2007-02-27T02:43:25.000Z
draft: false
tags:
  - Rails
  - capping
---

時間が無いのでメモだけ。

##### feed の生成に時間がかかる

4.4秒って…。FeedToolsの使い方が悪いのか、そういうものなのか…。

```
Processing HistoriesController#feed (for XXXXX at 2007-02-27 08:36:02) [GET]
  Parameters: {"action"=>"feed", "controller"=>"histories"}
Completed in 4.44582 (0 reqs/sec) | Rendering: 0.00008 (0%) | DB: 0.00038 (0%) | 200 OK [http://capping.machu.jp/histories/feed]
```

一応、キャッシュしているから何とかなると思うけど。

##### キャッシュが有効だとヘッダの Content/Type が書き換わらない

```
$ wget -S http://capping.machu.jp/histories/feed 
 4 Content-Type: text/xml;charset=utf-8
$ wget -S http://capping.machu.jp/histories/feed
 4 Content-Type: text/html
```

一回目（キャッシュなし）は書き換わるのに、二回目（キャッシュあり）は text/html になってしまっている。 アクションキャッシュだから、アクションメソッド内で headers を設定しているのが原因だと思って、フィルタに変えてみたけど状況は変わらず…ううん。
