---
title: さくらで HyperEstraier
date: 2007-07-28T00:00:00.000Z
lastmod: 2007-08-02T22:35:09.000Z
draft: false
tags:
  - FreeBSD
  - hyperestraier
---

全文検索システムの[HyperEstraier](http://hyperestraier.sourceforge.net/)は便利なんだけど、レンタルサーバで使うのは結構難しい。

* CGI 経由で更新をすると、通信断によってデータベースが壊れる場合がある
* cron でデータベースを更新すると、更新時は検索ができない
* [P2P ガイド](http://hyperestraier.sourceforge.net/nguide-ja.html)に書かれているノードサーバは独自プロセスなのでレンタルサーバで使えない

諦めるか〜と思っていたら、[さくらでHyperEstraier](http://eojareth.net/diary/20070215.html)というのを見つけた。 擬似ノードマスタを使えば、CGI経由でノードマスターを動かせるらしい。

それで挑戦してみたんだけど、結果は NG 。

[Tracの場合](http://weekbuild.sakura.ne.jp/trac/wiki/TracDoc/SakuraInternet)と同じように、シェル経由で LD\_LIBRARY\_PATH を渡すようにした。

```
#!/bin/sh
LD_LIBRARY_PATH=/home/XXX/lib;export LD_LIBRARY_PATH
/home/XXX/bin/estfraud.cgi
```

これで estfraud.cgi は動くんだけど、インデックスが読み込めない。

* estfraud.conf が読めない場合は 500 エラー
* 読めるけどインデックスが無い場合は 404 エラー
* estcmd create でインデックスを作った場合は 400 Bad Request エラー

うーん。そもそも estcmd でインデックスを作っていいものかどうか。

TextDrive で試そうと思ったら make が動かない…。

[hyperestraier の擬似ノードマスタ - HsbtDiary (2007-02-21)](http://www.hsbt.org/diary/20070221.html#p03)

> cgi 実行時に LD\_LIBRARY\_PATH を設定できなくて実行時に ld-elf うげほがエラー

これはシェル経由で起動すれば動くかも？
