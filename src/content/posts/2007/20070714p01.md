---
title: スパンボリュームの落とし穴
date: 2007-07-14T00:00:00.000Z
lastmod: 2007-07-16T14:33:18.000Z
draft: false
tags:
  - memo
---

メインで使っている PC の悪くなったので、 OS を入れなおそうと作業していたら大失敗してしまった。 いつでも気軽に再インストールできるように、プログラムはCドライブに、データはDドライブに入れるようにしているんだけど、Cドライブのパーティションを削除したら、Dドライブまで見えなくなってしまった。

マシンの構成は以下の通り。[スパンボリューム](http://technet2.microsoft.com/WindowsServer/ja/library/6acba350-817a-4fd1-a79c-183601c48be81041.mspx?mfr=true)を使って、HDD1とHDD2をDドライブとして認識させていたのが特徴。

* HDD1 … Cドライブ, Dドライブ
* HDD2 … Dドライブ

[Microsoft サポートオンライン](http://support.microsoft.com/kb/816307/ja)に以下のような記述があった。

> Windows 2000、Windows XP または Windows Server 2003 のテキスト モード セットアップの実行中や、回復コンソールを使用してコンピュータを起動している場合は、ダイナミック ディスク上のパーティションを削除したり、パーティションを作成したりしないでください。これを行うと、データが完全に失われる可能性があります。

んー。普通にCドライブとDドライブの2つがあると考えちゃいけなかったのね。 さて、どうしたものか。

* パーティションを削除したのは、HDD1のCドライブ
* HDD1とHDD2のDドライブには何もしていない（ので、データは無事なはず）
* インストーラからは、削除したはずのCドライブが見えなくなっている（ので、CドライブにOSを入れなおすことができない）

一番やっちゃいけないのは、慌てていろんな復旧策を試すこと。 原理的には全てのデータは残っているはずなので、じっくりと元に戻す方法を考えよう。 今のところ、以下の手順での復旧を考えている。

* HDD を1台買ってくる。
* 買ってきた HDD に OS を新規インストールする。
* インストールした OS を起動し、 HDD1 と HDD2 のデータが認識できるかどうか確認する。

うまくいけば HDD1 と HDD2 の D ドライブを認識、最悪でもHDD2のデータだけでも認識してほしいところだけど、ちょっと甘いかもなぁ。 ダメだったら、以下のサイトを参考に頑張ってみる予定。

* [ディスクの管理ツールで、システム ディスクまたはブート ディスクが "ダイナミック"、" 読み込み不能" と表示される](http://support.microsoft.com/kb/236086/)
* [誤って削除した NTFS または FAT32 ダイナミック ボリュームの復元方法](http://support.microsoft.com/default.aspx?scid=kb;ja;JP245725)

最大の教訓は、「再インストール前にはバックアップ必須！」ってこと。 正直痛い…けど、 Windows のディスク管理の仕組みを知るいい機会と思って、前向きに考えるか。
