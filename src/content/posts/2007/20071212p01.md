---
title: 503 エラーとツッコミ SPAM
date: 2007-12-12T00:00:00.000Z
lastmod: 2007-12-12T22:38:58.000Z
draft: false
tags:
  - tDiary
---

最近たまにこの日記で 503 のエラーが起きる。 一日のページビューなんてわずかなもので、負荷の原因になることはないはず。 何かのプラグインが負荷が高いのかも…と思ってたんだけど、もしかしたらツッコミ SPAM が原因かも。 例の対策で SPAM はフィルタできているんだけど、フィルタ後のログをみてビックリした。

```
$ du -m spamcomments
5       spamcomments
$ wc -l spamcomments
   39426 spamcomments
$ grep From spamcomments | wc -l
    5371
```

このファイルは昨日の朝に消したばかり。わずか1日半で5000件以上の SPAM が来てる。 う〜ん。ちょっと考えるなぁ。 hsbt さんが「[うちは2週間前のコメント欄を閉じるようにしたら軽くなった](http://twitter.com/hsbt/statuses/490190812)」言ってるけど、そうした方がいいのかもしれない。

#### 追記

[hsbt さんの日記](http://www.hsbt.org/diary/20071212.html#p02)に取り上げられてた。

> ツッコミ spam 対策は「ツッコミをさせてからフィルタではじく」という方向ではなく、「自分の日記の傾向に従ってツッコミすらさせない」という方向で考えないとダメかもねー。

なるほど。 [tDiary で ツッコミを spam とみなす日数が過ぎたらツッコミフォームを非表示にする](http://www.hsbt.org/diary/20071110.html#p01)パッチを入れてみようとしたけど、パッチがうまく当たらなかったのでやめた。 それに、ツッコミと同じだけ TrackBack が来ているので、本当はそっちも対処しなきゃいけない訳だし。

ふと、ツッコミフォームを Ajax で取得するようにしたら…と思ったんだけど、確か SPAM エンジンは JavaScript も 解釈するんだった気がする。 うーん。
