---
title: はてな認証APIで tDiary にログイン (2)
date: 2006-05-22T00:00:00.000Z
lastmod: 2006-05-22T13:41:28.000Z
draft: false
tags:
  - tDiary
  - hatena
---

[昨日の日記](/posts/20060521/p01)の続き。 tDiary 外部認証機能において、セキュリティ面で気になっているところをリストアップしておく（ToDoリストとも言う）。

- 無条件ですべてのパラメータに署名するようにしているので、任意のパラメータに対する署名を第三者が入手できる（[参考: Kazuho@Cybozu Labs](http://labs.cybozu.co.jp/blog/kazuho/archives/2006/05/hatena_auth_api-2.php)）。
- ログイン前からセッションを発行しているので、Session Fixation の危険性がある（[参考: ＠IT：Webアプリケーションに潜むセキュリティホール](http://www.atmarkit.co.jp/fsecurity/rensai/webhole14/webhole05.html)）

~~Ruby の CGI::Session の仕様によるけど、 URL へのセッション ID 埋め込みに対応していなければ、（XSS 脆弱性がない限りは）後者の問題は大丈夫なはず。~~ Ruby のセッション管理の仕様については、[ruby-list の議論](http://blade.nagaokaut.ac.jp/cgi-bin/vframe.rb/ruby/ruby-list/40383?40351-40569)を読むとよさそう。

#### 追記

[Cookie Monster](http://www.atmarkit.co.jp/fsecurity/rensai/hoshino06/hoshino02.html)という、同一ドメインの別サーバから任意の Cookie データを送り込む攻撃もあるとの[指摘をいただいた](https://www.machu.jp/diary/20060522.html#c01 "[kazuho] Session Fixation については、Cookie Monster のような問題もあるので、 Cookie ..")。 やはりログイン後に Cookie を発行するように対策しないとダメだ。
