---
title: VMware Player での時刻同期
date: 2006-07-12T00:00:00.000Z
lastmod: 2006-07-13T17:26:15.000Z
draft: false
tags:
  - VMware
  - Debian
---

[ノートPCに VMware Player を入れて使っている](/posts/20060609/p01)。 VMware の利点は、ノートPCの電源を切るときでも、 VMware 側の環境はサスペンドしておけること。 VMware 上の screen 環境を残しておけるので、重宝している。

でも一つ欠点があって、サスペンドしておいた VMware をレジュームすると、時刻が遅れてしまう。 どうやら、サスペンドしている間は VMware 上の時間が止まっているみたい。 ネット上を調べていると、[VMware playerでの時刻同期方法](http://www.dzeta.jp/tech/index.cgi?VMware%20player%A4%C7%A4%CE%BB%FE%B9%EF%C6%B1%B4%FC%CA%FD%CB%A1)というページが見つかった。 [仮想の背中](http://chitchat.at.infoseek.co.jp/vmware/vmtoolsj.html)から、 vmw をダウンロードしてコンパイルすればいいみたい。以下作業メモ。ちなみにゲストOSは Debian 。

```
$ wget http://chitchat.at.infoseek.co.jp/vmware/vmw-060510.tar.gz
$ tar zxvf vmw-060510.tar.gz
$ cd vmw/src
$ make
$ sudo cp vmw /usr/local/bin/
```

vmw は VMware のいろいろな機能を使うことができるコマンド。 時刻を合わせるには、以下のコマンドを実行する。

```
$ sudo vmw t -u
```

vmw の使い方は、コマンドオプションなしの vmw や、 -h オプションを使って調べた。

```
$ vmw
Usage: vmw <command>[-q|-c|-v][-d][-h][command specific options]

<command>
  a[pm]     execute an APM function
  co[py]    copy text into clipboard
  (中略)
  t[ime]    get host system time / sync guest system time
```

```
$ vmw t -h
Usage: vmw time [{-u|-U}][{-r|-R}[interval]][-g]
  -u  Update the guest system clock using local time
```

これを cron に登録して、1分ごとに実行するようにした。

```
0-59 * * * * /usr/local/bin/vmw t -u > /dev/null
```

Linux の時刻管理の問題か、時計合わせの瞬間に時間が 20 秒ほどずれることがあるんだけど、まぁご愛嬌かな。
